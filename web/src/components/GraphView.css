.graph {
  width: 100%;
  height: 100%;
  position: relative;
  background: radial-gradient(circle at top, rgba(79, 140, 255, 0.1), transparent 60%),
    radial-gradient(circle at 20% 80%, rgba(126, 240, 194, 0.08), transparent 55%),
    #0f1624;
  border-radius: 18px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.graph__legend-bar {
  padding: 12px 20px;
  background: rgba(13, 21, 33, 0.95);
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  display: flex;
  gap: 32px;
  align-items: center;
  flex-wrap: wrap;
  font-size: 11px;
}

.graph__legend-section {
  display: flex;
  gap: 16px;
  align-items: center;
}

.graph__legend-title {
  color: #a0aec0;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-size: 10px;
}

.graph__legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  color: #cfe0ff;
}

.graph__legend-icon {
  width: 16px;
  height: 16px;
  border-radius: 4px;
  border: 1.5px solid;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
}

.graph__svg-container {
  flex: 1;
  position: relative;
  overflow: hidden;
}

svg {
  width: 100%;
  height: 100%;
  display: block;
}

.graph__edge path {
  fill: none;
  stroke-width: 2.5px;
  opacity: 0.9;
  vector-effect: non-scaling-stroke;
}

/* High-contrast underlay for edges to ensure visibility */
.graph__edge-bg {
  stroke: rgba(240, 248, 255, 0.28); /* light backdrop */
  stroke-width: 6px;
  opacity: 0.85;
  mix-blend-mode: screen;
}

.graph__edge-fg {
  stroke-linecap: round;
  stroke-linejoin: round;
}

.graph__edge-label {
  font-size: 10px;
  fill: #cfe0ff;
  paint-order: stroke;
  stroke: rgba(15, 22, 36, 0.9);
  stroke-width: 3px;
}

.graph__edge-arrow {
  opacity: 0.9;
  vector-effect: non-scaling-stroke;
}

.graph__node rect {
  fill: rgba(13, 21, 33, 0.92);
  stroke-width: 2px;
  filter: drop-shadow(0 12px 24px rgba(15, 22, 36, 0.4));
}

.graph__node text {
  fill: #f2f6fc;
  pointer-events: none;
}

.graph__node-type {
  font-size: 0.75rem;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  fill: rgba(255, 255, 255, 0.7);
}

.graph__node-label {
  font-size: 0.95rem;
  font-weight: 600;
}

.graph__node--selected rect {
  stroke-width: 3px;
  filter: drop-shadow(0 0 20px rgba(79, 140, 255, 0.8));
}

.graph__node--policy rect {
  fill: rgba(79, 140, 255, 0.12);
}

.graph__node--group rect {
  fill: rgba(255, 196, 128, 0.12);
}

.graph__node--user rect {
  fill: rgba(97, 198, 255, 0.12);
}

.graph__node--role rect {
  fill: rgba(212, 134, 255, 0.12);
}

.graph__node--servicePrincipal rect {
  fill: rgba(126, 240, 194, 0.12);
}

.graph__node--namedLocation rect {
  fill: rgba(255, 136, 136, 0.12);
}

.graph__node--device rect {
  fill: rgba(155, 167, 255, 0.12);
}

.graph__node--keyword rect {
  fill: rgba(255, 255, 255, 0.08);
}

.graph__node--organization rect {
  fill: rgba(240, 191, 90, 0.12);
}
