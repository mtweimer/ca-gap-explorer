.graph {
  width: 100%;
  height: 100%;
  position: relative;
  background: var(--bg-primary);
  border-radius: 12px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.graph__legend-bar {
  padding: 10px 16px;
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-subtle);
  display: flex;
  gap: 24px;
  align-items: center;
  flex-wrap: wrap;
  font-size: 11px;
}

.graph__legend-section {
  display: flex;
  gap: 12px;
  align-items: center;
}

.graph__legend-title {
  color: var(--text-muted);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-size: 10px;
}

.graph__legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  color: var(--text-secondary);
}

.graph__legend-icon {
  width: 16px;
  height: 16px;
  border-radius: 4px;
  border: 1.5px solid;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
}

.graph__svg-container {
  flex: 1;
  position: relative;
  overflow: hidden;
}

svg {
  width: 100%;
  height: 100%;
  display: block;
}

.graph__edge path {
  fill: none;
  stroke-width: 2.5px;
  opacity: 0.9;
  vector-effect: non-scaling-stroke;
}

.graph__edge-bg {
  stroke: rgba(185, 163, 130, 0.2);
  stroke-width: 6px;
  opacity: 0.85;
  mix-blend-mode: screen;
}

.graph__edge-fg {
  stroke-linecap: round;
  stroke-linejoin: round;
}

.graph__edge-label {
  font-size: 10px;
  fill: var(--text-secondary);
  paint-order: stroke;
  stroke: var(--bg-primary);
  stroke-width: 3px;
}

.graph__edge-arrow {
  opacity: 0.9;
  vector-effect: non-scaling-stroke;
}

.graph__node rect {
  fill: var(--bg-secondary);
  stroke-width: 2px;
  filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.3));
}

.graph__node text {
  fill: var(--text-primary);
  pointer-events: none;
}

.graph__node-type {
  font-size: 0.75rem;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  fill: var(--text-muted);
}

.graph__node-label {
  font-size: 0.95rem;
  font-weight: 600;
}

.graph__node--selected rect {
  stroke-width: 3px;
  filter: drop-shadow(0 0 20px rgba(185, 163, 130, 0.6));
}

.graph__node--policy rect {
  fill: rgba(185, 163, 130, 0.15);
}

.graph__node--group rect {
  fill: rgba(238, 174, 51, 0.15);
}

.graph__node--user rect {
  fill: rgba(122, 184, 217, 0.15);
}

.graph__node--role rect {
  fill: rgba(173, 108, 255, 0.15);
}

.graph__node--servicePrincipal rect {
  fill: rgba(140, 68, 27, 0.15);
}

.graph__node--namedLocation rect {
  fill: rgba(224, 85, 69, 0.15);
}

.graph__node--device rect {
  fill: rgba(55, 53, 87, 0.15);
}

.graph__node--keyword rect {
  fill: rgba(255, 255, 255, 0.08);
}

.graph__node--organization rect {
  fill: rgba(140, 68, 27, 0.15);
}
